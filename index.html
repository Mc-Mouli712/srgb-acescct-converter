<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>sRGB → ACEScct Converter</title>
  <style>
    body { font-family: sans-serif; background:#1c1c1c; color:#fff; display:flex; flex-direction:column; align-items:center; padding:20px;}
    input { padding:10px; font-size:16px; margin:10px; width:150px;}
    button { padding:10px 20px; font-size:16px; margin:10px; cursor:pointer;}
    .color-box { width:100px; height:50px; margin:5px; border:1px solid #fff;}
    .row { display:flex; align-items:center; margin:10px;}
  </style>
</head>
<body>
  <h1>sRGB → ACEScct Hex Converter</h1>

  <div class="row">
    <input id="srgbHex" type="text" placeholder="#RRGGBB">
    <div class="color-box" id="srgbBox"></div>
  </div>

  <div class="row">
    <input id="acesHex" readonly placeholder="#RRGGBB">
    <div class="color-box" id="acesBox"></div>
    <button id="copyBtn">Copy ACES Hex</button>
  </div>

  <button id="convertBtn">Convert</button>

  <script>
    // Helper functions
    function hexToLinearRGB(hex) {
      let r = parseInt(hex.slice(1,3),16)/255;
      let g = parseInt(hex.slice(3,5),16)/255;
      let b = parseInt(hex.slice(5,7),16)/255;

      // sRGB → linear
      const linear = (c) => c<=0.04045 ? c/12.92 : Math.pow((c+0.055)/1.055,2.4);
      return [linear(r), linear(g), linear(b)];
    }

    function linearRGBtoACEScct(rgb) {
      // sRGB linear → ACES2065-1 (using ACES2065-1 primaries)
      // simplified matrix from sRGB D65 → ACES AP1
      let [r,g,b] = rgb;
      let R = 0.59719*r + 0.35458*g + 0.04823*b;
      let G = 0.07600*r + 0.90834*g + 0.01566*b;
      let B = 0.02840*r + 0.13383*g + 0.83777*b;

      // ACEScct encoding
      const toCCT = (c) => c<=0.0078125 ? 10.5402377416545*c : (Math.log2(c*0.002 + 1.0)*0.5 + 0.010) ;
      return [toCCT(R), toCCT(G), toCCT(B)];
    }

    function linearToHex(rgb) {
      const clamp = (c) => Math.min(1, Math.max(0, c));
      return "#" + rgb.map(c => Math.round(clamp(c)*255).toString(16).padStart(2,'0')).join('');
    }

    document.getElementById('convertBtn').onclick = () => {
      let srgbHex = document.getElementById('srgbHex').value;
      if(!/^#([0-9a-fA-F]{6})$/.test(srgbHex)) { alert("Enter valid #RRGGBB hex"); return; }

      document.getElementById('srgbBox').style.backgroundColor = srgbHex;

      let linearRGB = hexToLinearRGB(srgbHex);
      let acesRGB = linearRGBtoACEScct(linearRGB);

      let acesHex = linearToHex(acesRGB);
      document.getElementById('acesHex').value = acesHex;
      document.getElementById('acesBox').style.backgroundColor = acesHex;
    }

    document.getElementById('copyBtn').onclick = () => {
      document.getElementById('acesHex').select();
      document.execCommand('copy');
      alert("ACEScct Hex copied!");
    }
  </script>
</body>
</html>
<script src="renderer.js"></script>

